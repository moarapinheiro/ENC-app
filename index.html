<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enteral Nutrition Calculation</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1e3a8a">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

body{
    font-family: 'Inter', sans-serif;
    margin:0;
    background:linear-gradient(160deg,#0f172a,#0b1220);
    color:#e2e8f0;
    transition:all 0.3s ease;
}

header{
    background:rgba(30,58,138,0.85);
    backdrop-filter: blur(12px);
    color:white;
    padding:22px;
    text-align:center;
    font-size:20px;
    font-weight:600;
    letter-spacing:0.5px;
}

.tabs{
  display:flex;
  background:#111827;
}

.tabButton{
  flex:1;
  padding:16px;
  border:none;
  background:#111827;
  font-size:15px;
  font-weight:500;
  color:#94a3b8;
  transition:0.3s;
}

.tabButton.active{
  background:#1e40af;
  color:white;
  transform:scale(1.02);
}

.tabButton:hover{
  background:#1e3a8a;
  color:white;
}

.container{
    padding:20px;
}

.card{
    background:rgba(30,41,59,0.6);
    backdrop-filter: blur(16px);
    padding:22px;
    margin-bottom:20px;
    border-radius:18px;
    box-shadow:0 10px 30px rgba(0,0,0,0.4);
    animation:fadeIn 0.5s ease;
}

input, select{
    width:100%;
    padding:14px;
    margin-top:8px;
    margin-bottom:15px;
    border-radius:12px;
    border:1px solid #334155;
    background:#0f172a;
    color:white;
    font-size:16px;
    transition:0.3s;
}

input:focus, select:focus{
    border-color:#3b82f6;
    outline:none;
    box-shadow:0 0 0 2px rgba(59,130,246,0.3);
}

button{
    width:100%;
    padding:15px;
    background:linear-gradient(135deg,#2563eb,#1e40af);
    color:white;
    border:none;
    border-radius:14px;
    font-size:17px;
    font-weight:600;
    transition:0.3s;
}

button:hover{
    transform:translateY(-2px);
    box-shadow:0 6px 18px rgba(37,99,235,0.4);
}

.resultCard{
    background:#0f172a;
    padding:18px;
    border-radius:14px;
    margin-top:15px;
    line-height:1.7;
    animation:slideUp 0.4s ease;
}

.icon{
    margin-right:6px;
}

@keyframes fadeIn{
    from{opacity:0; transform:translateY(10px);}
    to{opacity:1; transform:translateY(0);}
}

@keyframes slideUp{
    from{opacity:0; transform:translateY(20px);}
    to{opacity:1; transform:translateY(0);}
}
</style>
</head>
<body>

<header>游봎 Enteral Nutrition Calculation </header>

<div class="tabs">
  <button class="tabButton active" onclick="mostrarAba(event,'pleno')">Volume Pleno</button>
  <button class="tabButton" onclick="mostrarAba(event,'manual')">Ajuste Manual</button>
</div>

<div class="container">

<!-- ================= VOLUME PLENO ================= -->
<div id="pleno">

<div class="card">

<h3>游빑 C치lculo Volume Pleno</h3>

Peso (kg)
<input type="number" id="peso">

Altura (m)
<input type="number" step="0.01" id="altura">

Meta Cal칩rica (kcal/kg)
<input type="number" id="metaKcal">

Meta Proteica (g/kg)
<input type="number" id="metaProt">

Tipo de Dieta
<select id="dietaSelect">
  <option value="tipo1">Tipo 1</option>
  <option value="tipo2">Tipo 2 s/ fibra</option>
  <option value="imuno">Imunomoduladora</option>
</select>

<button onclick="calcularPleno()">Calcular</button>

<div id="resultadoPleno"></div>

</div>

</div>

<!-- ================= AJUSTE MANUAL ================= -->
<div id="manual" style="display:none;">

<div class="card">

<h3>丘뙖잺 Ajuste Manual</h3>

Peso (kg)
<input type="number" id="pesoManual">

Altura (m)
<input type="number" step="0.01" id="alturaManual">

Volume administrado (mL)
<input type="number" id="volumeManual">

M칩dulo de prote칤na (g)
<input type="number" id="moduloManual">

Tipo de Dieta
<select id="dietaManual">
  <option value="tipo1">Tipo 1</option>
  <option value="tipo2">Tipo 2 s/ fibra</option>
  <option value="imuno">Imunomoduladora</option>
</select>

<button onclick="calcularManual()">Calcular</button>

<div id="resultadoManual"></div>

</div>

</div>

</div>

<script>

function mostrarAba(event,id){
  document.getElementById("pleno").style.display="none";
  document.getElementById("manual").style.display="none";
  document.getElementById(id).style.display="block";

  document.querySelectorAll(".tabButton").forEach(btn=>btn.classList.remove("active"));
  event.target.classList.add("active");
}

function obterDieta(valor){
  if(valor==="tipo1") return {densidade:1.2, protMl:0.045, nome:"Tipo 1"};
  if(valor==="tipo2") return {densidade:1.5, protMl:0.075, nome:"Tipo 2 s/ fibra"};
  if(valor==="imuno") return {densidade:1.09, protMl:0.065, nome:"Imunomoduladora"};
}

function classificarIMC(imc){
  if(imc < 18.5) return "Baixo peso";
  if(imc < 25) return "Eutrofia";
  if(imc < 30) return "Sobrepeso";
  if(imc < 35) return "Obesidade Grau I";
  if(imc < 40) return "Obesidade Grau II";
  return "Obesidade Grau III";
}

function copiarTexto(texto){
  navigator.clipboard.writeText(texto);
  alert("Prescri칞칚o copiada!");
}

function calcularPleno(){

let peso = parseFloat(document.getElementById("peso").value);
let altura = parseFloat(document.getElementById("altura").value);
let metaKcal = parseFloat(document.getElementById("metaKcal").value);
let metaProt = parseFloat(document.getElementById("metaProt").value);
let dieta = obterDieta(document.getElementById("dietaSelect").value);

if(!peso || !metaKcal || !metaProt){
  alert("Preencha todos os campos");
  return;
}

let metaKcalTotal = peso * metaKcal;
let metaProtTotal = peso * metaProt;

let volume = metaKcalTotal / dieta.densidade;
let protDieta = volume * dieta.protMl;

let modulo = Math.max(0, metaProtTotal - protDieta);

let ofertaCaloricaReal = volume * dieta.densidade;
let ofertaProteicaReal = protDieta + modulo;

let kcalKg = ofertaCaloricaReal / peso;
let protKg = ofertaProteicaReal / peso;

let vel24 = volume / 24;
let vel20 = volume / 20;

let imc = altura ? peso/(altura*altura) : null;
let imcTexto = imc ? `${imc.toFixed(1)} (${classificarIMC(imc)})` : "-";

let prescricao = 
`Dieta enteral ${dieta.nome}
Volume: ${volume.toFixed(0)} mL/dia
Velocidade: ${vel24.toFixed(1)} mL/h (24h)
M칩dulo de prote칤na: ${modulo.toFixed(1)} g/dia
Oferta cal칩rica total: ${ofertaCaloricaReal.toFixed(0)} kcal
Oferta proteica total: ${ofertaProteicaReal.toFixed(1)} g
kcal/kg: ${kcalKg.toFixed(1)}
Prote칤na/kg: ${protKg.toFixed(2)} g/kg`;

document.getElementById("resultadoPleno").innerHTML = `
<div class="resultCard">
<b>${dieta.nome}</b><br><br>

IMC: ${imcTexto}<br><br>

<b>Volume pleno:</b> ${volume.toFixed(0)} mL<br>
<b>Velocidade (24h):</b> ${vel24.toFixed(1)} mL/h<br>
<b>Velocidade (20h):</b> ${vel20.toFixed(1)} mL/h<br><br>

<b>M칩dulo necess치rio:</b> ${modulo.toFixed(1)} g<br><br>

<b>Oferta cal칩rica total:</b> ${ofertaCaloricaReal.toFixed(0)} kcal<br>
<b>Oferta proteica total:</b> ${ofertaProteicaReal.toFixed(1)} g<br><br>

<b>kcal/kg:</b> ${kcalKg.toFixed(1)}<br>
<b>Prote칤na/kg:</b> ${protKg.toFixed(2)} g/kg<br><br>

<button onclick='copiarTexto(\`${prescricao}\`)'>Copiar Prescri칞칚o</button>
</div>
`;
}

function calcularManual(){

let peso = parseFloat(document.getElementById("pesoManual").value);
let altura = parseFloat(document.getElementById("alturaManual").value);
let volume = parseFloat(document.getElementById("volumeManual").value);
let modulo = parseFloat(document.getElementById("moduloManual").value)||0;
let dieta = obterDieta(document.getElementById("dietaManual").value);

if(!peso || !volume){
  alert("Preencha peso e volume");
  return;
}

let kcal = volume * dieta.densidade;
let protTotal = (volume * dieta.protMl) + modulo;
let imc = altura ? peso/(altura*altura) : null;
let imcTexto = imc ? `${imc.toFixed(1)} (${classificarIMC(imc)})` : "-";

let prescricao = 
`Dieta enteral ${dieta.nome}
Volume: ${volume.toFixed(0)} mL/dia
M칩dulo de prote칤na: ${modulo.toFixed(1)} g/dia
Oferta cal칩rica: ${kcal.toFixed(0)} kcal
Oferta proteica: ${protTotal.toFixed(1)} g
Kcal/kg/dia: ${(kcal/peso).toFixed(1)}
Prote칤na/kg/dia: ${(protTotal/peso).toFixed(2)} g/kg`;

document.getElementById("resultadoManual").innerHTML = `
<div class="resultCard">
<b>${dieta.nome}</b><br><br>
IMC: ${imcTexto}<br>
Oferta cal칩rica total: ${kcal.toFixed(0)} kcal<br>
Oferta proteica total: ${protTotal.toFixed(1)} g<br>
Kcal/kg/dia: ${(kcal/peso).toFixed(1)}<br>
Prote칤na/kg/dia: ${(protTotal/peso).toFixed(2)} g/kg<br><br>
<button onclick='copiarTexto(\`${prescricao}\`)'>Copiar Prescri칞칚o</button>
</div>
`;
}

if('serviceWorker' in navigator){
  navigator.serviceWorker.register('service-worker.js');
}

</script>

</body>
</html>